# Tavus æ•°å­—äºº - å®Œæ•´ Context ä¿¡æ¯ç»“æ„

## ğŸ“Š æ¦‚è¿°

Tavus æ•°å­—äºº (Olivia) ç°åœ¨æ¥æ”¶**ä¸°å¯Œçš„ã€å¤šç»´åº¦çš„ç”¨æˆ·æ•°æ®**ï¼Œä½¿å…¶èƒ½å¤Ÿè¿›è¡Œæ›´ä¸ªæ€§åŒ–ã€æ›´æ™ºèƒ½çš„å¯¹è¯ã€‚

---

## ğŸ“‹ ä¼ é€’ç»™æ•°å­—äººçš„å®Œæ•´æ•°æ®ç»“æ„

### 1ï¸âƒ£ **ä¸ªäººä¿¡æ¯** (Personal Information)
```
- å§“å (Name)
- ç”¨æˆ· ID (User ID)
- å¥åº·ç›®æ ‡ (Health Goal) - ä¾‹å¦‚ï¼š"Keep stable glucose levels"
- å¥åº·çŠ¶å†µ (Conditions) - ä¾‹å¦‚ï¼š"Type 2 Diabetes"
- CGM è®¾å¤‡ç±»å‹ (CGM Device Type) - ä¾‹å¦‚ï¼š"Freestyle Libre"
```

### 2ï¸âƒ£ **å½“å‰è¡€ç³–çŠ¶æ€** (Current CGM Status)
```
- å½“å‰è¡€ç³–å€¼ (Current Glucose) - ä¾‹å¦‚ï¼š114 mg/dL
- è¡€ç³–çŠ¶æ€ (Status) - Low / Normal / Elevated / High
- äººå·¥è¯Šæ–­ä¿¡æ¯ - âœ… In range / âš ï¸ Below target / âš¡ Slightly elevated
```

### 3ï¸âƒ£ **24 å°æ—¶ç»Ÿè®¡** (24-Hour Metrics)
```
- å¹³å‡è¡€ç³– (Average Glucose) - ä¾‹å¦‚ï¼š118.4 mg/dL
- æœ€ä½è¡€ç³– (Min Glucose) - ä¾‹å¦‚ï¼š82 mg/dL
- æœ€é«˜è¡€ç³– (Max Glucose) - ä¾‹å¦‚ï¼š156 mg/dL
- ç›®æ ‡èŒƒå›´å†…æ—¶é—´ (Time In Range 70-140) - ä¾‹å¦‚ï¼š74.7%
- è¯»æ•°æ¬¡æ•° (Reading Count) - ä¾‹å¦‚ï¼š48 æ¬¡
```

### 4ï¸âƒ£ **7 å¤©ç»Ÿè®¡** (7-Day Metrics)
```
- 7 å¤©å¹³å‡è¡€ç³– (7-Day Average Glucose)
- 7 å¤©ç›®æ ‡èŒƒå›´å†…æ—¶é—´ (7-Day Time In Range)
```

### 5ï¸âƒ£ **æ£€æµ‹åˆ°çš„è¡€ç³–æ¨¡å¼** (Detected Patterns)
```
æ¯ä¸ªæ¨¡å¼åŒ…å«ï¼š
- æ¨¡å¼åç§° (Pattern Name) - ä¾‹å¦‚ï¼špost_meal_spike, dawn_phenomenon
- ä¸¥é‡ç¨‹åº¦ (Severity) - low / medium / high
- ç½®ä¿¡åº¦ (Confidence) - 0-100% (ä¾‹å¦‚ï¼š85%)
- æ¨¡å¼æè¿° (Description) - å¯¹æ¨¡å¼çš„è¯¦ç»†è§£é‡Š

ç¤ºä¾‹ï¼š
- post_meal_spike (high, 85% confidence): 
  Glucose spikes after meals, particularly after high-carb meals
```

### 6ï¸âƒ£ **æœ€è¿‘çš„è¡€ç³–è¯»æ•°** (Recent Glucose Readings - Last 20)
```
æ¯æ¡è¯»æ•°åŒ…å«ï¼š
- æ—¶é—´æˆ³ (Timestamp)
- è¡€ç³–å€¼ (Glucose Value) in mg/dL
- çŠ¶æ€ (Status) - Low / Normal / Elevated / High

ç¤ºä¾‹æ˜¾ç¤ºï¼šæœ€å¤šå‰ 10 æ¡æœ€è¿‘è¯»æ•°çš„è¯¦ç»†è®°å½•
```

### 7ï¸âƒ£ **å¥åº·å»ºè®®** (Recommended Health Actions)
```
æ¯æ¡å»ºè®®åŒ…å«ï¼š
- æ ‡é¢˜ (Title) - ä¾‹å¦‚ï¼š"Reduce refined carbohydrates"
- è¯¦ç»†è¯´æ˜ (Detail) - å…·ä½“å»ºè®®å†…å®¹
- ç±»åˆ« (Category) - diet / exercise / sleep / medication
- ä¼˜å…ˆçº§ (Priority) - 1-5 çº§ (é«˜çº§ä¼˜å…ˆçº§æ˜¾ç¤º)

ç¤ºä¾‹æ˜¾ç¤ºï¼šæœ€å¤šå‰ 5 æ¡é«˜ä¼˜å…ˆçº§å»ºè®®
```

### 8ï¸âƒ£ **å¯¹è¯æŒ‡ç¤º** (Instructions for Olivia)
Olivia è¢«æ˜ç¡®æŒ‡ç¤ºï¼š
1. çƒ­æƒ…åœ°é—®å€™ç”¨æˆ·å¹¶ç¡®è®¤ä»–ä»¬çš„å½“å‰è¡€ç³–çŠ¶æ€
2. åˆ©ç”¨ä¸ªäººä¿¡æ¯æ¥å®šåˆ¶å›åº”
3. å‚è€ƒæ£€æµ‹åˆ°çš„æ¨¡å¼å¹¶è§£é‡Šå…¶å«ä¹‰
4. åŸºäº 24 å°æ—¶å’Œ 7 å¤©è¶‹åŠ¿æä¾›æ´å¯Ÿ
5. å¦‚æœæœ‰é«˜ä¼˜å…ˆçº§å»ºè®®ï¼Œä¸»åŠ¨æå‡ºå»ºè®®
6. å±•ç¤ºå¯¹æ”¹è¿›å’Œç”¨æˆ·åšå¾—å¥½çš„åœ°æ–¹çš„çƒ­æƒ…
7. å¯¹æ•°æ®ä¸­æ˜¾ç¤ºçš„ä»»ä½•æŒ‘æˆ˜è¡¨ç¤ºæ”¯æŒ
8. æå‡ºåç»­é—®é¢˜ä»¥äº†è§£ç”¨æˆ·å¯¹è¡€ç³–ç®¡ç†çš„æ„Ÿå—

---

## ğŸ”„ æ•°æ®æµç¨‹

```
Flask API (åç«¯)
    â†“
    â”œâ”€ /api/user/{userId}              â†’ ä¸ªäººä¿¡æ¯
    â”œâ”€ /api/glucose/{userId}           â†’ å½“å‰è¡€ç³–
    â”œâ”€ /api/stats/{userId}             â†’ 24å°æ—¶ç»Ÿè®¡
    â”œâ”€ /api/stats/{userId}?days=7      â†’ 7å¤©ç»Ÿè®¡
    â”œâ”€ /api/recent/{userId}/20         â†’ æœ€è¿‘20æ¡è¯»æ•°
    â”œâ”€ /api/patterns/{userId}          â†’ æ£€æµ‹åˆ°çš„æ¨¡å¼
    â””â”€ /api/actions                    â†’ å¥åº·å»ºè®®
    â†“
App.tsx - fetchUserData()
    â†“
buildConversationalContext()  (æ ¼å¼åŒ–ä¸º markdown)
    â†“
Tavus API v2/conversations
    â”œâ”€ conversational_context (ä¸Šè¿°æ‰€æœ‰ä¿¡æ¯)
    â””â”€ custom_greeting (ç”¨æˆ·åå’Œæ¬¢è¿è¯)
    â†“
Tavus Video Avatar (Olivia)
    â†“
ç”¨æˆ·å¯¹è¯å¼€å§‹ ğŸ¥
```

---

## ğŸ“Š Context ç¤ºä¾‹

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    USER PROFILE & HEALTH CONTEXT               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ‘¤ PERSONAL INFORMATION:
- Name: John Doe
- User ID: user_001
- Health Goal: Keep stable glucose levels and reduce medication usage
- Conditions: Type 2 Diabetes
- CGM Device: Freestyle Libre

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š CURRENT CGM STATUS:
- Current Glucose: 114 mg/dL (Normal) ğŸ©º
- Status: âœ… In range

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“ˆ GLUCOSE STATISTICS:

24-Hour Metrics:
- Average: 118.4 mg/dL
- Min-Max: 82 - 156 mg/dL
- Time In Range (70-140): 74.7%
- Reading Count: 48

7-Day Metrics:
- Average: 120.2 mg/dL
- Time In Range (70-140): 72.1%

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ” DETECTED GLUCOSE PATTERNS (Last 24h):
- post_meal_spike (high, 85% confidence): Glucose spikes after meals, particularly after high-carb meals
- dawn_phenomenon (medium, 72% confidence): Elevated glucose in early morning hours
- post_exercise_drop (low, 58% confidence): Gradual glucose decrease during/after exercise

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“‹ RECENT GLUCOSE READINGS (Last 20):
  2025-10-27T08:30:00Z: 156 mg/dL (Elevated)
  2025-10-27T08:00:00Z: 142 mg/dL (Elevated)
  2025-10-27T07:30:00Z: 128 mg/dL (Normal)
  ...

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ’¡ RECOMMENDED HEALTH ACTIONS:
- [diet] Reduce refined carbohydrates: Try replacing white rice with brown rice or quinoa. (Priority: 5)
- [exercise] Increase daily activity: Aim for at least 30 minutes of moderate exercise. (Priority: 4)
- [diet] Improve meal timing: Eat meals at consistent times to stabilize glucose. (Priority: 4)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

INSTRUCTIONS FOR OLIVIA:
1. Greet John Doe warmly and acknowledge their current glucose status
2. Use the personal information to tailor your response
...
```

---

## âœ¨ æ•°å­—äººèƒ½åšä»€ä¹ˆ

æœ‰äº†è¿™äº›ä¸°å¯Œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ŒOlivia ç°åœ¨å¯ä»¥ï¼š

âœ… **ä¸ªæ€§åŒ–é—®å€™**
- "Hi John! I see your glucose is at 114 mg/dL and in target range. Great work!"

âœ… **å‚è€ƒå…·ä½“æ•°æ®**
- "Your Time In Range is 74.7%, which shows good control. Let's keep pushing for 80%!"
- "I noticed your 7-day average is 120.2 mg/dL, up slightly from yesterday..."

âœ… **è¯†åˆ«å’Œè§£é‡Šæ¨¡å¼**
- "I've detected a post-meal spike pattern with 85% confidence. This means your glucose tends to spike after meals, especially high-carb ones. Let me suggest some strategies..."

âœ… **æä¾›é’ˆå¯¹æ€§å»ºè®®**
- "Based on your dawn phenomenon pattern, I'd recommend a light evening snack with protein..."

âœ… **è¿½è¸ªè¶‹åŠ¿**
- "Your Time In Range improved 2.1% compared to last week! You're doing amazing!"

âœ… **æ™ºèƒ½å¯¹è¯**
- "I see you had some elevated readings after lunch. How did that meal feel to you?"

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### æ–‡ä»¶ä½ç½®
- **App.tsx**: `cgm-avatar-app/src/App.tsx`
- **æ ¸å¿ƒå‡½æ•°**:
  - `fetchUserData()` - ä» Flask API è·å–æ‰€æœ‰æ•°æ®
  - `buildConversationalContext()` - æ ¼å¼åŒ–ä¸º markdown context

### API ç«¯ç‚¹
Flask åç«¯å¿…é¡»æä¾›ä»¥ä¸‹ç«¯ç‚¹ï¼š
- `GET /api/user/<user_id>` - ç”¨æˆ·ä¿¡æ¯
- `GET /api/glucose/<user_id>` - å½“å‰è¡€ç³–
- `GET /api/stats/<user_id>?days=7` - ç»Ÿè®¡æ•°æ®
- `GET /api/recent/<user_id>/20` - æœ€è¿‘è¯»æ•°
- `GET /api/patterns/<user_id>` - æ£€æµ‹æ¨¡å¼
- `GET /api/actions` - å¥åº·å»ºè®®

### æµè§ˆå™¨æ§åˆ¶å°è°ƒè¯•
å¯åŠ¨ React åº”ç”¨åï¼Œåœ¨æµè§ˆå™¨ DevTools Console ä¸­å¯ä»¥çœ‹åˆ°ï¼š
```
ğŸ“ Initializing for user: user_001
Creating conversation with context: [å®Œæ•´çš„æ ¼å¼åŒ– context]
âœ… Conversation created successfully
Conversation URL: https://tavus.daily.co/...
```

---

## ğŸ¯ ä½¿ç”¨å»ºè®®

1. **ç›‘æ§ Console è¾“å‡º**: æŸ¥çœ‹å®Œæ•´çš„ context ä¿¡æ¯äº†è§£æ•°å­—äººè·å¾—äº†ä»€ä¹ˆæ•°æ®
2. **æµ‹è¯•ä¸åŒç”¨æˆ·**: åˆ‡æ¢ç”¨æˆ·çœ‹ context å¦‚ä½•å˜åŒ–
3. **æ•°æ®æ›´æ–°**: Flask API çš„æ•°æ®è¶Šæ–°é²œï¼ŒOlivia çš„å¯¹è¯å°±è¶Šå‡†ç¡®
4. **æ¨¡å¼æ£€æµ‹**: ç¡®ä¿ pattern_identification æ¨¡å—å®šæœŸè¿è¡Œï¼Œä»¥è·å¾—æœ€æ–°çš„æ¨¡å¼æ£€æµ‹

---

## ğŸ“ ç›¸å…³æ–‡ä»¶

- `cgm-avatar-app/src/App.tsx` - React åº”ç”¨ä¸»æ–‡ä»¶
- `dashboard/app.py` - Flask API åç«¯
- `digital_avatar/config.py` - é…ç½®æ–‡ä»¶
- `database/cgm_database.py` - æ•°æ®åº“æ¥å£

